<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css"
	th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.min.css}" />
<link rel="stylesheet" type="text/css" th:href="@{/css/main.css}" />
<meta charset="utf-8" />
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet"
	href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" />
<script
	src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js"
	type="text/javascript"></script>
<script
	src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.0.2/dist/tfjs-vis.umd.min.js"></script>
<!--     <script src="js/redneuronal.js"></script> -->
<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css"
	rel="stylesheet" type="text/css" />
<!-- 	<script src="/js/datatable.js"></script> -->
<title>Registro de Clase</title>
<style>
.slidecontainer {
	width: 100%;
}

.slider {
	-webkit-appearance: none;
	width: 100%;
	height: 25px;
	background: #d3d3d3;
	outline: none;
	opacity: 0.7;
	-webkit-transition: .2s;
	transition: opacity .2s;
}

.slider:hover {
	opacity: 1;
}

.slider::-webkit-slider-thumb {
	-webkit-appearance: none;
	appearance: none;
	width: 25px;
	height: 25px;
	background: #4CAF50;
	cursor: pointer;
}

.slider::-moz-range-thumb {
	width: 25px;
	height: 25px;
	background: #4CAF50;
	cursor: pointer;
}

.loader {
  position: absolute;
  left: 50%;
  top: 50%;
  z-index: 1;
  width: 150px;
  height: 150px;
  margin: -75px 0 0 -75px;
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid blue;
  border-right: 16px solid green;
  border-bottom: 16px solid red;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
}

.loader2 {
  position: absolute;
  left: 43%;
  top: 60%;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.animate-bottom {
  position: relative;
  -webkit-animation-name: animatebottom;
  -webkit-animation-duration: 1s;
  animation-name: animatebottom;
  animation-duration: 1s
}

@-webkit-keyframes animatebottom {
  from { bottom:-100px; opacity:0 } 
  to { bottom:0px; opacity:1 }
}

@keyframes animatebottom { 
  from{ bottom:-100px; opacity:0 } 
  to{ bottom:0; opacity:1 }
}

#myDiv {
  display: none;
  text-align: center;
}
</style>
</head>
<body>


	<div class="loader">
	</div>
	
	<div class="loader2">
		<p>Preparando modelo predictivo...</p>
	</div>
	<div class="container animate-bottom" style="display:none;" id="myDiv" >
		<div class="row">
			<div class="col-md-10 col-md-offset-1">
				<div class="panel panel-default">
					<div class="panel-body">
						<div class="text-center">
							<h3>
								<i class="glyphicon glyphicon-user" style="font-size: 2em;"></i>
							</h3>
							<h2 class="text-center">Registro de Clase</h2>
							<div class="panel-body">
								<div th:if="${param.success}">
									<div class="alert alert-info">!Se registro la clase
										satisfactoriamente!</div>
								</div>

								<form id="frmClase" method="post">


									<div class="form-group">
										<h2>Bienvenido</h2>
										<div sec:authentication="name"></div>
									</div>
									<div class="form-group">
										<label class="form-control">Fecha de clase</label> <input
											id="fechaConsulta" data-date-format="yyyy-mm-dd"
											class="form-control" width="276"
											placeholder="Confirmar fecha" />
									</div>
									<div class="form-group">
										<label class="form-control">Sección</label> <select
											disabled="disabled">
											<option id="1">3 años A</option>
										</select>
									</div>
									<div class="form-group">
										<button type="button" onclick="consultar()"
											class="btn btn-success btn-block">Consultar</button>
									</div>
								</form>
								<table id="alumnosTable" class="display">

									<!-- Header Table -->
									<thead>
										<tr>
											<th>Id</th>
											<th>Documento</th>
											<th>Nombre</th>
											<th>Email</th>
											<th>Telefono</th>
											<th>¿Calificado?</th>
											<th>Calificar</th>
											<th>Predecir</th>
										</tr>
									</thead>
									<!-- Footer Table -->
									<tfoot>
										<tr>
											<th>Id</th>
											<th>Documento</th>
											<th>Nombre</th>
											<th>Email</th>
											<th>Telefono</th>
											<th>¿Calificado?</th>
											<th>Calificar</th>
											<th>Predecir</th>
										</tr>
									</tfoot>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal -->
	<div id="mdCalificacion" class="modal fade" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Calificacion</h4>
				</div>
				<div class="modal-body">
					<div class="form-group">
						<input type="hidden" id="idAlumno" name="idAlumno" /> <label
							class="form-control">Documento</label> <input id="docAlumno"
							name="docAlumno" readonly="readonly" />
					</div>
					<div class="form-group">
						<label class="form-control">Nombre del Alumno</label> <input
							id="nombreAlumno" name="nombreAlumno" readonly="readonly" />
					</div>
					<div class="form-group">
						<label class="form-control">Actividad</label> <select
							id="selActividad" name="selActividad">
							<option value="">---Seleccione---</option>
							<option value="1">Actidad 1</option>
							<option value="2">Actidad 2</option>
							<option value="3">Actidad 3</option>
						</select>
					</div>
					<div class="form-group">
						<label class="form-control">Recursos Didácticos</label>
						<!--              	<select id="selRecurso" name="selRecurso"> -->
						<!--              	</select> -->
						<div id="dvRecurso"></div>
					</div>
					<!--             <div class="form-group"> -->
					<!--              <label class="form-control">¿Lo utilizó?</label> -->
					<!--              	<input type="radio" name="utilizo" value="0"> SI</input> -->
					<!-- 				<input type="radio" name="utilizo" value="1"> NO</input> -->
					<!--             </div> -->

				</div>
				<div class="modal-footer">
					<button type="button" onclick="grabarClase()"
						class="btn btn-default" data-dismiss="modal">Guardar</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
				</div>
			</div>

		</div>
	</div>
	
	<div id="mdPrediccion" class="modal fade" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Predicción</h4>
				</div>
				<div class="modal-body">
					<div class="form-group">
						<input type="hidden" id="idAlumnoPred" name="idAlumnoPred" /> <label
							class="form-control">Documento</label> <input id="docAlumnoPred"
							name="docAlumnoPred" readonly="readonly" />
					</div>
					<div class="form-group">
						<label class="form-control">Nombre del Alumno</label> <input
							id="nombreAlumnoPred" name="nombreAlumnoPred" readonly="readonly" />
					</div>
					<div class="form-group">
						<label class="form-control">Nombre del Alumno</label>
					</div>
					<div id="dvEstilo"></div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
				</div>
			</div>

		</div>
	</div>
	<script type="text/javascript">
    var table;
    $(document).ready( function () {
//    	 $('#fechaConsulta').datepicker();
   	$("#fechaConsulta").datepicker({ dateFormat: 'yy-mm-dd' });
//    	var table = $('#alumnosTable').DataTable( {
//    	    paging: false
//    	} );
   });
    
    
    function abrirCalificacion(id, nombre, doc){
    	console.log(id);
    	console.log(nombre);
    	console.log(doc);
    	$('#nombreAlumno').val(nombre);
    	$('#docAlumno').val(doc);
    	$('#idAlumno').val(id);
    	
    	$('#mdCalificacion').modal('show');
    }
    
    function abrirPrediccion(id, nombre, doc){
    	console.log(id);
    	console.log(nombre);
    	console.log(doc);
    	
    	var formattedDate = new Date($('#fechaConsulta').val());
		var d = formattedDate.getDate();
		var m =  formattedDate.getMonth();
		m += 1;  // JavaScript months are 0-11
		var y = formattedDate.getFullYear();
		
		var fecha = "" + d + m + y;
    	
    	$.ajax({
    		url: 'http://localhost:8080/alumno/getalumno/'+fecha+'/1/'+id,
    		type:"GET",
    		success: function(respuesta) {
    			console.log(respuesta);
    			$('#nombreAlumnoPred').val(nombre);
    	    	$('#docAlumnoPred').val(doc);
    	    	$('#idAlumnoPred').val(id);
    	    	$('#dvEstilo').empty();
    			
    			var val1 = respuesta.val1;
    			var val2 = respuesta.val2;
    			var val3 = respuesta.val3;
    			var val4 = respuesta.val4;
    			testTensor = tf.tensor2d([val1,val2,val3,val4], [1, 4]);
//     			tfvis.show.modelSummary({name: 'Modelo de Predicción'}, model);
    			model.predict(testTensor).print();
    			const output = model.predict(testTensor);
    			const valores = output.dataSync();
    			
    			const porcEstilo1 = (valores[0]*100).toFixed(2);
    			const porcEstilo2 = (valores[1]*100).toFixed(2);
    			console.log('salida 1:', valores[0]);
    			console.log('salida 2:', valores[1]);
    			
    			const estilo1 = $('<div><label>LÓGICA MATEMÁTICA:</label> <input type="range" min="0" max="100" value="'+porcEstilo1+'" class="slider" id="estilo1" disabled="disabled"></input><label id="rangeText1">Valor: %'+porcEstilo1+'</label></div>');
    			estilo1.appendTo('#dvEstilo');
    			
    			const estilo2 = $('<div><label>ESPACIAL:</label> <input type="range" min="0" max="100" value="'+porcEstilo2+'" class="slider" id="estilo1" disabled="disabled"></input><label id="rangeText2">Valor: %'+porcEstilo2+'</label></div>');
    			estilo2.appendTo('#dvEstilo');
    			$('#mdPrediccion').modal('show');
    			
    		},
    		error: function() {
    	        console.log("No se ha podido obtener la información");
    	        tfvis.show.modelSummary({name: 'Modelo de Predicción'}, model);
    	    }
    	});
    	
    }
    
    $('#selActividad').on('change', function() {
    		$('#dvRecurso').empty();
			if($('#selActividad').val() == '1'){
// 				$('#selRecurso').append('<option value="1">Recurso 1A</option>');
// 				$('#selRecurso').append('<option value="2">Recurso 1B</option>');
// 				$('#selRecurso').append('<option value="3">Recurso 1C</option>');
// 				$('#selRecurso').append('<option value="4">Recurso 1D</option>');
				var check1 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="1"> Recurso 1A</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang1"></input><label id="rangeText1">Valor: 0</label></div>');
				var check2 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="2"> Recurso 1B</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang2"></input><label id="rangeText2">Valor: 0</label></div>');
				var check3 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="3"> Recurso 1C</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang3"></input><label id="rangeText3">Valor: 0</label></div>');
				var check4 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="4"> Recurso 1D</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang4"></input><label id="rangeText4">Valor: 0</label></div>');
				check1.appendTo('#dvRecurso');
				check2.appendTo('#dvRecurso');
				check3.appendTo('#dvRecurso');
				check4.appendTo('#dvRecurso');
				
				$('#rang1').on('input change', function () {
			        $('#rangeText1').text("Valor: "+$(this).val());
			    });
				$('#rang2').on('input change', function () {
			        $('#rangeText2').text("Valor: "+$(this).val());
			    });
				$('#rang3').on('input change', function () {
			        $('#rangeText3').text("Valor: "+$(this).val());
			    });
				$('#rang4').on('input change', function () {
			        $('#rangeText4').text("Valor: "+$(this).val());
			    });
			}else if($('#selActividad').val() == '2'){
// 				$('#selRecurso').append('<option value="5">Recurso 2A</option>');
// 				$('#selRecurso').append('<option value="6">Recurso 2B</option>');
// 				$('#selRecurso').append('<option value="7">Recurso 2C</option>');
// 				$('#selRecurso').append('<option value="8">Recurso 2D</option>');
				var check1 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="5"> Recurso 2A</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang5"></input><label id="rangeText5" value="Valor: 0" /></div>');
				var check2 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="6"> Recurso 2B</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang6"></input><label id="rangeText6" value="Valor: 0" /></div>');
				var check3 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="7"> Recurso 2C</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang7"></input><label id="rangeText7" value="Valor: 0" /></div>');
				var check4 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="8"> Recurso 2D</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang8"></input><label id="rangeText8" value="Valor: 0" /></div>');
				check1.appendTo('#dvRecurso');
				check2.appendTo('#dvRecurso');
				check3.appendTo('#dvRecurso');
				check4.appendTo('#dvRecurso');
				$('#rang5').on('input change', function () {
			        $('#rangeText5').text("Valor: "+$(this).val());
			    });
				$('#rang6').on('input change', function () {
			        $('#rangeText6').text("Valor: "+$(this).val());
			    });
				$('#rang7').on('input change', function () {
			        $('#rangeText7').text("Valor: "+$(this).val());
			    });
				$('#rang8').on('input change', function () {
			        $('#rangeText8').text("Valor: "+$(this).val());
			    });
			}else if($('#selActividad').val() == '3'){
// 				$('#selRecurso').append('<option value="9">Recurso 3A</option>');
// 				$('#selRecurso').append('<option value="10">Recurso 3B</option>');
// 				$('#selRecurso').append('<option value="11">Recurso 3C</option>');
// 				$('#selRecurso').append('<option value="12">Recurso 3D</option>');
				var check1 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="9"> Recurso 3A</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang9"> </input><label id="rangeText9" value="Valor: 0" /></div>');
				var check2 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="10"> Recurso 3B</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang10"> </input><label id="rangeText10" value="Valor: 0" /></div>');
				var check3 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="11"> Recurso 3C</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang11"> </input><label id="rangeText11" value="Valor: 0" /></div>');
				var check4 = $('<div><input type="checkbox" id="checkRecurso" name="checkRecurso" value="12"> Recurso 3D</input> <input type="range" min="0" max="100" value="0" class="slider" id="rang12"> </input><label id="rangeText12" value="Valor: 0" /></div>');
				check1.appendTo('#dvRecurso');
				check2.appendTo('#dvRecurso');
				check3.appendTo('#dvRecurso');
				check4.appendTo('#dvRecurso');
				$('#rang9').on('input change', function () {
			        $('#rangeText9').text("Valor: "+$(this).val());
			    });
				$('#rang10').on('input change', function () {
			        $('#rangeText10').text("Valor: "+$(this).val());
			    });
				$('#rang11').on('input change', function () {
			        $('#rangeText11').text("Valor: "+$(this).val());
			    });
				$('#rang12').on('input change', function () {
			        $('#rangeText12').text("Valor: "+$(this).val());
			    });
			}
    		 
    	});
    
    function intento(){
    	displayData(recursos);
      	tfvis.show.modelSummary({name: 'Modelo de Clasificacion'}, model);

    }
    function consultar(){
//     	$.ajax({
//     		url: 'http://localhost:8080/alumno/listalumnos/'+$('#fechaConsulta').val(),
//     		success: function(respuesta) {
//     			console.log(respuesta);
//     		},
//     		error: function() {
//     	        console.log("No se ha podido obtener la información");
//     	    }
//     	});
//     	$('#alumnosTable').empty();
//         $('#myTable').empty();

		var formattedDate = new Date($('#fechaConsulta').val());
		var d = formattedDate.getDate();
		var m =  formattedDate.getMonth();
		m += 1;  // JavaScript months are 0-11
		var y = formattedDate.getFullYear();
		
		var fecha = "" + d + m + y;
    	var table = $('#alumnosTable').DataTable({
   			"sAjaxSource": "/alumno/listalumnos/"+fecha,
   			"sAjaxDataProp": "",
   			"order": [[ 0, "asc" ]],
   			"paging": false,
   			"bDestroy": true,
   			"aoColumns": [
   			    { "mData": "id"},
   			 	{ "mData": "persona.documento" },
   			 	{ "mData": "persona.name" },   				  
   				{ "mData": "persona.email" },
   				{ "mData": "persona.telefono" },
   				{ "mData": "calificado" },
   	            {"mRender": function (data, type, full) {
                 return '<a href="#" onclick="abrirCalificacion('+full.id+',\''+full.persona.name+'\','+full.persona.documento+')" class="btn btn-primary ImprimirTicket">Calificar</a>'
                 }
   	            },
   	         	{"mRender": function (data, type, full) {
   	         		
   	         		if(full.calificado == 'NO'){
   	         			return 'NO';
   	         		}else{
   	         			return '<a href="#" onclick="abrirPrediccion('+full.id+',\''+full.persona.name+'\','+full.persona.documento+')" class="btn btn-primary ImprimirTicket">Predecir</a>'		
   	         		}
                 
                 }
   	            }
   			],
   			
   	 })
    }
    
    function grabarClase(){
    	
    	var formattedDate = new Date($('#fechaConsulta').val());
		var d = formattedDate.getDate();
		var m =  formattedDate.getMonth();
		m += 1;  // JavaScript months are 0-11
		var y = formattedDate.getFullYear();
		
		var fech = "" + d + m + y;
		
		var recursos = [];
		var valores = "";
		var rsc = "";
		
		$.each($("input[name='checkRecurso']:checked"), function(){
			recursos.push($(this).val());
        });
		
		$.each(recursos, function( index, value ) {
			  if(index==0){
					rsc = recursos[index];
					valores= $('#rang'+recursos[index]).val()
				}else{
					rsc += ","+ recursos[index];
					valores += ","+ $('#rang'+recursos[index]).val()
				}
			});
		
    	$.ajax({
    		url: 'http://localhost:8080/alumno/grabarClase',
    		type:"POST",
    		data:JSON.stringify({"fecha":fech, "idAlumno":$('#idAlumno').val(), "actividad":$('#selActividad').val(), "recursos":rsc, "valores":valores }),
    		contentType:"application/json; charset=utf-8",
    		dataType:"json",
    		success: function(respuesta) {
    			console.log(respuesta);
    			consultar();
    		},
    		error: function() {
//     	        console.log("No se ha podido obtener la información");
				consultar();
    	    }
    	});
//     	$('#alumnosTable').empty();
//         $('#myTable').empty();

    }
    
    getData = getDataFunction;
    createModel = createModelFunction;
    prepareData = prepareDataFunction
    trainModel = trainModelFunction;
    displayData = displayDataFunction;
    evaluateModel = evaluateModelFunction;
    
    var model;
    var tensorData;
    var testTensor;
    
    async function run() {
    	  $.ajax({
        		url: 'http://localhost:8080/alumno/getDataClaseAlumnos',
        		type:"GET",
        		success: function(respuesta) {
        			console.log('RUN DATA:', respuesta);
        	    	  $(".loader").css("visibility", "visible");
        	    	  
        	    		model = createModelFunction();  

        	    		tensorData = prepareDataFunction(respuesta);
        	    		const {inputs, outputs} = tensorData;
        	    			
        	    		trainModelFunction(model, inputs, outputs, 500);
        	    	  console.log('Done Training');
        	    	  $(".loader").css("visibility", "hidden");
        	    	  $(".loader2").css("visibility", "hidden");
        	    	  
        	    	  document.getElementById("myDiv").style.display = "block";
        			
        		},
        		error: function() {
        	        console.log("No se ha podido obtener la información");
        	        tfvis.show.modelSummary({name: 'Modelo de Predicción'}, model);
        	    }
        	});
    	}
    	/**@desc recuperar datos de un json de un archivo local 
    	 * @return null
    	*/
    	function loadJSON(path, callback) {   
    	  var xobj = new XMLHttpRequest();
    	      xobj.overrideMimeType("application/json");
    	  xobj.open('GET', path, true);
    	  xobj.onreadystatechange = function () {
    	        if (xobj.readyState == 4 ) {
    	        	if (xobj.status == "200") {
    	        		callback(xobj.responseText);	
					}
    	        }
    	  };
    	  xobj.send(null);  
    	}
    	/**
    	  * @desc retrieves data from defined location
    	  * @return wine data as json
    	*/
    	async function getDataFunction() {
    	  
    	  loadJSON("recursos.json", (response) => {
    	    const recursos = JSON.parse(response)
    	    // const data = await recursos.json();
    	    // console.log('response', data);
    	    return data;
    	  });

    	  // const wineDataReq = await fetch('https://raw.githubusercontent.com/NMZivkovic/file_hosting/master/wine_quality.json');  
    	  // const wineDataReq = await fetch('http://localhost:8080/alumno/promRecursos');  
    	  // const wineDataReq = JSON.parse(recursos);
    	  // console.log('getData', wineDataReq);
    	  // const wineData = await wineDataReq.json();  
    	  // return wineData;
    	}


    	/**
    	  * @desc plots one 
    	  * @param array values - array of values
    	  * @param string name - name of the plot
    	  * @param string xoutput - x name 
    	  * @param string youtput - y name
    	*/
    	function singlePlot(values, name, xoutput, youtput)
    	{
    	  tfvis.render.scatterplot(
    	    {name: name},
    	    {values}, 
    	    {
    	      xoutput: xoutput,
    	      youtput: youtput,
    	      height: 300,
    	      xLabel: "Recurso Utilizado",
    	      yLabel: "Estilo de Aprendizaje"
    	    }
    	  );
    	}

    	function histograma(values, name, xoutput, youtput) {
    	  // tfvis.render.barchart(
    	  //   {name: name}, 
    	  //   {values},
    	  //   {
    	  //    width: 400,
    	  //    yLabel: 'My value',
    	  //   }
    	  // );
    	  const data = [
    	    { index: 0, value: 50 },
    	    { index: 1, value: 100 },
    	    { index: 2, value: 150 },
    	   ];
    	  
    	  // Render to visor
    	  const surface = { name: 'Recursos Utilizados', tab: 'Visor' };
    	  tfvis.render.barchart(surface, values);
    	}

    	/**
    	  * @desc plots one 
    	  * @param json data - complete json that contains wine quality data 
    	*/
    	function displayDataFunction(data){

    	  
    	  // const data = [
    	  //   {index: 'foo', value: 1},{index: 'bar', value: 7}, {index: 3, value: 3},
    	  //   {index: 5, value: 6}];
    	  // tfvis.render.barchart(document.getElementById('plot5'), data, {
    	  //   yLabel: 'My value',
    	  //   width: 400
    	  // });
    	  
    	  // histograma(1, 1, 1, 1);
    	  

    	  let displayData = data.map(d => ({
    	    x: d.recurso1,
    	    y: d.estilo
    	  }));

    	  singlePlot(displayData, 'Recurso 1 v Estilo', 'Recursos', 'Estilo')

    	  displayData = data.map(d => ({
    	    x: d.recurso2,
    	    y: d.quality
    	  }));

    	  singlePlot(displayData, 'Recurso 2 v Estilo', 'Recursos', 'Estilo')

    	  displayData = data.map(d => ({
    	    x: d.recurso3,
    	    y: d.estilo
    	  }));

    	  singlePlot(displayData, 'Recurso 3 v Estilo', 'Recursos', 'Estilo')
    	}

    	/**
    	  * @desc creates tensorflow graph
    	  * @return model
    	*/
    	function createModelFunction() {
    	  const model = tf.sequential(); 
    	  model.add(tf.layers.dense({inputShape: [4], units: 6, activation: 'sigmoid'}));
    	  model.add(tf.layers.dense({units: 8, activation: 'sigmoid'}));
    	  // model.add(tf.layers.dense({units: 20, useBias: true, activation: 'sigmoid'}));

    	  return model;
    	}

    	/**
    	  * @desc creates array of input data for every sample
    	  * @param json data - complete json that contains wine quality data 
    	  * @return array of input data
    	*/
    	function extractInputs(data)
    	{
    	  let inputs = []
    	  inputs = data.map(d => [d.recurso1, d.recurso2, d.recurso3, d.recurso4])
    		return inputs;
    	}

    	/**
    	  * @desc converts data from json format to tensors
    	  * @param json data - complete json that contains wine quality data 
    	  * @return tuple of converted data that can be used for training model
    	*/
    	function prepareDataFunction(data) {
    	  
    	  return tf.tidy(() => {
    	    tf.util.shuffle(data);
    	    
    	    const inputs = extractInputs(data);
    	    const outputs = data.map(d => d.estilo);

    	    const inputTensor = tf.tensor2d(inputs, [inputs.length, inputs[0].length]);
    	    const outputTensor = tf.oneHot(tf.tensor1d(outputs, 'int32'), 8);

    	    const inputMax = inputTensor.max();
    	    const inputMin = inputTensor.min();  
    	    const outputMax = outputTensor.max();
    	    const outputMin = outputTensor.min();

    	    const normalizedInputs = inputTensor.sub(inputMin).div(inputMax.sub(inputMin));
    	    const normalizedoutputs = outputTensor.sub(outputMin).div(outputMax.sub(outputMin));

    	    return {
    	      inputs: normalizedInputs,
    	      outputs: normalizedoutputs,
    	      inputMax,
    	      inputMin,
    	      outputMax,
    	      outputMin,
    	    }
    	  });  
    	}

    	/**
    	  * @desc trains model
    	  * @return trained model
    	*/
    	async function trainModelFunction(model, inputs, outputs, epochs) {
    	  model.compile({
    	    optimizer: tf.train.sgd(0.1),
    	    loss: tf.losses.meanSquaredError
    	  });
    	  
    	  const batchSize = 64;
    	  
    	  return await model.fit(inputs, outputs, {
    	    batchSize,
    	    epochs,
    	    shuffle: true
    	  });
    	}

    	/**
    	  * @desc evaluates the model
    	*/
    	async function evaluateModelFunction(model, inputs, outputs)
    	{
    	  const result = await model.evaluate(inputs, outputs, {batchSize: 64});
    	  console.log('Accuracy is:')
    	  result[1].print();
    	}

    	document.addEventListener('DOMContentLoaded', run);

    	const recursos = [];
    	recursos.push({
    			"recurso1": 0,
    			"recurso2": 0,		
    			"recurso3": 0.89,
    	    "recurso4": 0.95,
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0,
    			"recurso3": 0.7,
    			"recurso4": 0.75,
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0.1,
    			"recurso3": 0.85,
    			"recurso4": 0.9,
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0.15,
    			"recurso3": 0.9,
    			"recurso4": 0.99,
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0,
    			"recurso3": 0.95,
    			"recurso4": 0.89,
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0,
    			"recurso3": 0.75,
    			"recurso4": 0.89,		
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0,
    			"recurso3": 0.75,
    			"recurso4": 0.89,		
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0,
    			"recurso3": 0.75,
    			"recurso4": 0.89,		
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0,
    			"recurso3": 0.75,
    			"recurso4": 0.89,		
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0,
    			"recurso3": 0.75,
    			"recurso4": 0.89,		
    	    "estilo": 1
    		}, {
    			"recurso1": 0,
    			"recurso2": 0,
    			"recurso3": 0.75,
    			"recurso4": 0.89,		
    	    "estilo": 1
    		}, {
    			"recurso1": 0.85,
    			"recurso2": 0.95,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		}, {
    			"recurso1": 0.95,
    			"recurso2": 0.9,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		}, {
    			"recurso1": 0.91,
    			"recurso2": 0.89,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		}, {
    			"recurso1": 0.91,
    			"recurso2": 0.89,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		}, {
    			"recurso1": 0.91,
    			"recurso2": 0.89,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		}, {
    			"recurso1": 0.91,
    			"recurso2": 0.89,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		}, {
    			"recurso1": 0.91,
    			"recurso2": 0.89,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		}, {
    			"recurso1": 0.91,
    			"recurso2": 0.89,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		}, {
    			"recurso1": 0.91,
    			"recurso2": 0.89,
    			"recurso3": 0,
    			"recurso4": 0,
    	    "estilo": 2
    		});


    </script>
</body>
</html>